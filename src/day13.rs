use dashu::integer::UBig;
use std::{error::Error, fmt::Display, iter};

pub fn run() -> Result<(), Box<dyn Error>> {
    let input = r##"
    ##.#.##
    #.##...
    .######
    ##....#
    #.##.#.
    .#.####
    .#.####
    #.##.#.
    ##....#
    .######
    #.##..#
    ##.#.##
    ..###..
    ..###..
    ##.#.##
    #.##..#
    .######
    
    ###....
    ##..###
    .####..
    .#.....
    ####.##
    .....##
    #..####
    .#...##
    #...###
    .###...
    .#..###
    ####.##
    ....###
    ....###
    ###..##
    
    ...##.##.##....
    .##.######.##..
    .##.#....#.##..
    ###.######.####
    #.##......##.##
    ..###.##.###...
    #####....######
    ####..##..#####
    .###.#....###..
    #####....######
    ..#........#...
    
    ####....##.
    ##.#....##.
    #..#.###.##
    .###...#.##
    ..###..#.#.
    #.#..#.#.#.
    .##..######
    ###..#....#
    ##.###..###
    ..##.#.##..
    .#.##.#.#.#
    .##.##.#.#.
    .##.##.#.#.
    .#.##.#.#.#
    ..##.#.##..
    
    ##...###..#.###
    ##...###..#.##.
    ##...###..#.##.
    ##...###..#.###
    ...###..###..#.
    #.###.##....#.#
    .#.#.#...#.#..#
    
    ###.#.##.#.##
    ..##.####.##.
    ##...#..#...#
    .....#..#....
    ####.####.#.#
    ..#.#.##.#.#.
    #####....####
    ..####..####.
    ..##########.
    ##..##..##..#
    ...#......#..
    ...#.####.#..
    ######..#####
    ###.######.##
    ##..##..##..#
    
    #.##.#...
    ..##...##
    ##..##.##
    ##..##...
    ..###.#..
    #.##.#...
    #.##.#.##
    #.##.#...
    #.##.#...
    ..##..#..
    #.##.##..
    ######.##
    #....####
    .......##
    ######.##
    .####..##
    #.##.####
    
    .####....#..##.##
    ..########..####.
    .#..##..#..####..
    #.#..#..###...###
    ..#...##.#..#.##.
    ###.#.##.###..##.
    ....###.#..####.#
    ....###.#..####.#
    ###.#.##.###..##.
    ..#...##.#..#.##.
    #.#..#..###...###
    .#..##..#..####..
    ..########..#.##.
    .####....#..##.##
    .####....#..##.##
    
    ...#..#...#.#.#
    ...#..##...#..#
    ####.###.#...##
    ..#..##.#.#....
    ##.#.#...#.#.#.
    .....###..#.#..
    ..#.#.#.....##.
    ..#.#.#.....##.
    .....###..#.#..
    ##.#.#...#.#.#.
    ..#..##.#.#....
    ####.#.#.#...##
    ...#..##...#..#
    ...#..#...#.#.#
    ######.....####
    
    .####.#
    ##..##.
    ###.###
    ......#
    ......#
    #....##
    #....##
    
    ...##...##.#.#.
    ...##...##.#.#.
    ##....##.#.#.#.
    #..##......#.##
    ...##...#######
    ########....#.#
    .##..##......##
    #......#..#...#
    #..##..##.#.###
    
    .##.###...#
    .##.###..##
    .##.##.###.
    #..##..##..
    #..#..#.#..
    #..#..#####
    ....##.####
    ....#..####
    ####.......
    #..#.##.#..
    #####.##.##
    
    ..#.#.#.##....#..
    .#...###.##.#..#.
    .#...###.##.#..#.
    ..#.#.#.##....#..
    ##..#.#..#..#.#.#
    .#.#..#.#.##.....
    .......###.......
    ####..#...#.##.##
    .#.#.#...........
    .#...#...........
    ####..#...#.##.##
    
    ##..###.#....
    #....###....#
    ..##....#....
    .####...##..#
    .#..#.#.#..#.
    .####...#...#
    #.##.#.#...##
    ..##.....##..
    ########..#.#
    #....########
    .####....##..
    #.##.#..####.
    #.##.#.#####.
    
    #.#..##.###
    #.#..###...
    .#.#.##.#..
    .####...###
    ####..##...
    ...##...#..
    ##.#.###...
    #..##..##..
    #..#.##..##
    .######.###
    ..#####.###
    
    #.#.####.#.#.###.
    #.#.####.#.#.###.
    #.###..###.##.##.
    #.#.####.#.##..#.
    ############.##.#
    .#.######.#.#....
    ...#....#...#.###
    #..##..##..#..#..
    .##......##..###.
    ...##..##...##..#
    ..#..##..#...###.
    .....##......####
    ..###..#.#..###.#
    #.#.#..#.#.#.##..
    .###....###..#.##
    ##.#.##.#.###..##
    .#........#..#.##
    
    #..####..####
    ###.##.######
    ####..#######
    #...##...#..#
    ###....###..#
    #........#..#
    ###.##.###..#
    ..#....#.....
    ............#
    #..####..#..#
    .##....##....
    ##.#..#.#####
    ###.##.######
    ....##.......
    ###....######
    ##......##..#
    ...#..#......
    
    .###.#..##..##..#
    #..#######..#####
    .#.##.##.#..#.##.
    ..........##.....
    ..........##.....
    ##...###.####.###
    #.#.##..######..#
    ##.#######..#####
    #.....##..##..##.
    #....############
    .#.#.#..######..#
    #.##.####.##.####
    ###.#####.##.####
    .#..#.##.####.##.
    #..##.##.#..#.##.
    .#####..#....#..#
    #.##.#..######..#
    
    ####.##.##.##.#
    ..#............
    #####..####..##
    .###....##....#
    ..###..####..##
    #...#..#..#..#.
    .#...##....##..
    .#.#.##.##.##.#
    #..............
    #..#....##....#
    ....#..#..#..#.
    .#.############
    .##############
    ....##########.
    ...#.##.##.##.#
    
    ...........#...
    .#.##.#..#..###
    ########..#####
    ..........#.###
    #......#...#.##
    #.####.####..##
    .#....#......##
    .#....#.#.#.###
    ...##.......#..
    #.####.##....##
    #......##.#....
    ###..#####..#..
    #........##.#..
    
    ##########.#.##.#
    #.##.#...##..#..#
    ##..###.#..###.#.
    ##..###.#..###.#.
    #.##.#...##..#..#
    ##########.#.##.#
    ########.....##..
    #.##.##.##....##.
    ........##..#...#
    #....#.##..#...#.
    #.######...##.#..
    
    ....#..
    #..###.
    ..###.#
    ..##..#
    #..###.
    ....#..
    ####...
    ...##..
    ..#.###
    ##...#.
    #.#..#.
    #.#..#.
    ##...#.
    
    .###.##.###.#..
    .....##.....###
    ##.######.##...
    #..######..##..
    #.#.#..#.#.##..
    .##......##..##
    ...######....##
    .##.#..#.##.###
    .##.#.##.##..##
    ###......######
    #....##....####
    ....#..#.......
    ..#......#..#..
    
    #..#######.
    #..########
    .#.#..##.##
    .#.##...#.#
    .#.##...#.#
    .#.#..##.##
    #..########
    #..#######.
    ..#.##.##..
    
    .##....##.###.#
    ..##..##....#..
    ..##..##.......
    .##....##.###.#
    ##......###.###
    #.#....#.##.##.
    #.#....#.#.#.##
    #.######.##....
    ..#.##.#..#.##.
    ...####...#.##.
    .#.####.#..#..#
    ###....###.##..
    ##..##..##.##..
    
    ####.##..####
    ####.##..####
    ..#.#######.#
    .#.##.#.##...
    .###...##.#..
    .##.###.####.
    .##..#.#....#
    .##..#.#....#
    .##.###.####.
    .###...##.#..
    .#.##.#..#...
    ..#.#######.#
    ####.##..####
    
    ####..#.##....#
    ####..#.##.....
    #..##.###.##.##
    ......#...##.#.
    ....#.##.##....
    ####.#.#.##.#..
    #..#..#####..##
    ............#.#
    #..#..##.#...#.
    
    ####.##.####..#
    .##..##..##..#.
    #..#....#..#...
    .##......##...#
    .####..####....
    .....##.....#.#
    #..#....#..#...
    ####.##.#######
    ....####....#.#
    
    ##..#.....###..#.
    ....#.##.##...###
    #..####.##...#.##
    ##.##..###...#.#.
    ##.#.####.##.....
    #.####.###.#.##..
    ##.#..###.#..##..
    ###.#.#.#.#.#.#..
    ###.#.#.#...#.#..
    ....#..#.#.#..##.
    ..#.#.###.#.#..#.
    ..#.#.###.#.#..#.
    ....#..#.#.#..##.
    ###.#.#.#...#.#..
    ###.#.#.#.#.#.#..
    
    .#.##..##.#..
    .##########..
    ..##.##.##...
    #...#..#.....
    ...##..##....
    .#.######.#..
    #...#..#...##
    #.#......#.##
    .###.##.###..
    .#.#.##.#.#..
    #..######..##
    #.#..##..#.##
    .#.######.#..
    #....##....##
    .#..#..#..#..
    #.#.#..#.#.##
    .##########..
    
    ....###.....####.
    ##.####..#.#..#.#
    ####.##..#.##...#
    ...#....#...##..#
    ...#...#....##..#
    ####.#.#..##.####
    ....#.###.#......
    ##.##...####...##
    ##.##...####...##
    ....#.###.#......
    ####.#.#..##.###.
    ...#...#....##..#
    ...#....#...##..#
    
    ..#.##..#
    ..#.##..#
    #######..
    #..#.##..
    #.#....##
    #..#...#.
    ###.#.#..
    #.#.#..##
    #.#.#..##
    ###.#.#..
    #..#...#.
    #.#....##
    #..#.##..
    #######..
    ..#.##.##
    
    ....#.##.####
    #.##.#...#...
    ..####..#..##
    ##...#...#.##
    #.####..##.##
    ###..######..
    .##..######..
    
    #..####.#.#
    #..####.#.#
    #...#.#.#.#
    .##.#.##..#
    #..##..####
    ##..##.##..
    ####..##.#.
    #.##..##.#.
    ##..##.##..
    
    ##.#..#.###.#..
    ##..#.######.#.
    ###..#.##.#....
    ##.####.#.####.
    ..#.####.#.#..#
    ...#.#.##.###..
    ###....#.#.#..#
    ..#.###.##..##.
    ...#.###.###...
    ############.#.
    ###########..#.
    
    .##....
    .#.#...
    #..####
    #..####
    .#.#...
    .##....
    ...#..#
    
    .#.##.#..##..#.
    ..####....#..##
    #......#....#.#
    .######.#..#.##
    .........#####.
    ..####..#......
    ..####..#......
    .........#####.
    .######.#..#.##
    #......#....#.#
    ..####....#..##
    .#.##.#..##..#.
    .#.#..#.##..#..
    .#.##.#...####.
    .#.##.#.#...#..
    
    ...#.#..#
    ##..#....
    ###......
    ###......
    ##..#....
    ...#.#..#
    #...##..#
    ..##....#
    ..#.##..#
    #.....##.
    #....####
    
    ...###..###
    #..##..####
    ##.##.....#
    ..#..###..#
    .#.##.###..
    #...###.###
    ....#.#.##.
    #...#......
    #...#......
    ....#.#.##.
    #...###.###
    .#.##.###..
    ..#..###..#
    ##.##.....#
    #..##..####
    ...###..###
    ....##..###
    
    ..##.#.#..#..#.##
    ..#.#..##.#.###..
    ..#.#..##.#.###..
    ..##.#.#..#..#.##
    #..##.##..#.##.##
    .#####.#..###...#
    ...#.....##.####.
    ..#....#..##..#..
    .#..##.#..###.##.
    ....#.####.####.#
    ...#.###..#..#..#
    .##.#.#..###...##
    ..#.#.#..###...##
    
    .###.###...
    ##..#...##.
    .##.#.....#
    ...#...#...
    ##.#...#.#.
    ##.#...#.#.
    ...#...#...
    .##.#...#.#
    ##..#...##.
    .###.###...
    #.##.##.##.
    #.##.##.##.
    .###.###...
    
    .#.##......
    .#.##......
    ..##.##..##
    ....##.##.#
    ...###.##.#
    ##.##..##..
    .##.##....#
    ##.#..#..#.
    .#..#.....#
    
    #..#.##..#..#..
    #..#....#..##..
    .##.#.#####.##.
    ####.#.##......
    .##.##..##.....
    #..#.###.###...
    .##.........#..
    #####..#.#.....
    .##.#.#........
    .....#..#....##
    ####.###..###..
    #..#.##..#.##..
    .##.###...#####
    
    #..#.#.##..#..#
    .##.#.###.....#
    .##.#..##.#...#
    ########.#..##.
    ####.#.#####.##
    ....##...#.##..
    ....#.##.###.#.
    ..........#.#..
    ..........#.#..
    ....#.##.##..#.
    ....##...#.##..
    
    ..#####.####...#.
    ......#.#.###.##.
    .##.#...#..#..###
    .##.#...#..#..###
    ......#.#.###.##.
    ..#####.####...#.
    #.####....#.#..#.
    ####.##..#.###.#.
    ..#..##.#..###..#
    ##....###.##.#.##
    .##....###.##..#.
    .##....###.##..#.
    ##....###.##.#.#.
    
    ..#.####.##......
    ....####.##......
    .#.###.###.#....#
    #.###..##########
    ....###.##.######
    #......#.#.######
    ##...#..#..#.##.#
    
    ....#...##..#.#..
    #..#....#....#..#
    .#..##..#..#.#...
    ..#.#..#..#.##.##
    .##...##.##..##..
    .##...##.##..##..
    ..#.#..#..#.##.##
    .#..##..#..#.#...
    #..#....#....#..#
    ....#...##..#.#..
    ....##...#....###
    .#..#.#.#..##..##
    #...##..###....##
    #...##..###....##
    .#..#.#....##..##
    
    ..#..#.#..##.#..#
    #.#.###..##.#.##.
    ..##..####..#####
    .#.##..#...#.####
    ###.#.#..##.#####
    ###.#...#.###.##.
    ###.#.###..#..##.
    #..#....#.##..#..
    ..###....#..##..#
    #.#####.##.#.####
    #.##.#...#..##..#
    ##.....###...#..#
    #...##....#...##.
    .###.#..#.#######
    .###.#..#.#######
    
    .##.#..
    ###....
    #.#....
    ...#..#
    #..####
    ###....
    ###....
    #..####
    ...#..#
    
    ##.....#..#..
    ....##.####.#
    ....#.#.##.#.
    .#.#.#......#
    #....##....##
    ##..##.#..#.#
    #.#.#..###...
    ####.##.##.##
    ####.##.##.##
    
    ......###....
    ...##.####.##
    ..#..######..
    ##..##....##.
    ###.#.#..#.#.
    ......#..#...
    ###..##..##..
    ##.##......##
    .....######..
    ..####.##.###
    .......##....
    ...#.#....#.#
    ..###......##
    ###.##....##.
    ##..#.####.#.
    ###.#..##..#.
    ...##.#..#.##
    
    ..#.##.#....#
    ..######....#
    #..#..#..##..
    ....##.......
    #..####..##..
    ..#....#....#
    ##.####.####.
    #.#.##.#.##.#
    #..#..#......
    #.#....#.##.#
    #..####..##..
    ##......####.
    .##....##..##
    
    #...#.#
    #...#.#
    ####.#.
    ..##..#
    .######
    ....#..
    .##..#.
    ....#..
    ....#..
    .##..##
    ....#..
    .######
    ..##..#
    ####.#.
    #...#.#
    
    ..##...#..##...##
    .......#.#.##.#.#
    ......#..###.#.#.
    ......#####.#..##
    ##..##.#####..###
    ##..###.#.###.#.#
    .......#.#.##..##
    ..##...#.#.#.##.#
    ##..##..#..##.#.#
    ##..####.##.#.###
    ##..###.#.#.##..#
    .......#..#.##.#.
    ..##...##.#.#.###
    ##..##.######.#..
    .#..#.##.##..##..
    ..##......##.#.##
    ..##..#..#.....#.
    
    .#....####.
    ..#.#.####.
    .#####....#
    ##...######
    ##.....##..
    .#..#..##..
    ..##.#....#
    #...###..##
    #...###..##
    ..##.#....#
    ##..#..##..
    ##.....##..
    ##...######
    
    .##.##..#
    ##...####
    #...#..##
    ##....#..
    ....#..##
    ...#.####
    ...#.####
    ....#..##
    ##....#..
    
    #.##..##.##..#.#.
    #........##.#....
    ###....######..##
    ...####...#..###.
    ##......##....#..
    ..#.##.#...##.###
    #........#.####..
    #.#....#.#.#..##.
    #.#....#.#.#..##.
    #........#.####..
    ..#.##.#....#.###
    
    ......#..#.##..##
    ......#..#.##..##
    #.#.##.....###.##
    #..###....##.#..#
    ..#.##..###....#.
    .#.#.#..##....##.
    #.#....#.##...#.#
    .##..###.#.#.##.#
    .##..###.#.#.##.#
    #.#....#.##...#.#
    .#.#.#..##....##.
    ..#.##.####....#.
    #..###....##.#..#
    #.#.##.....###.##
    ......#..#.##..##
    
    .#.###....###.###
    ....##.#.###....#
    ##....#.#.#.##...
    ##....#.#.#.##...
    ....##.#.###....#
    .#.###....###.###
    ..#..#.#...##.#..
    .#.#..#...####.##
    #..#...#.###...##
    .##.#.#.#..#..#.#
    .##.#.#.#..#..#.#
    #..#...#.###...##
    ...#..#...####.##
    ..#..#.#...##.#..
    .#.###....###.###
    ....##.#.###....#
    ##....#.#.#.##...
    
    ##..##..####.
    .#..#.#.####.
    .####.#.#..#.
    ###.###.#..#.
    ##..##...##..
    ######..####.
    ......#.#..#.
    .#..#........
    ##..##.######
    ######.##..##
    .####..#....#
    
    ##...#..#...#
    ###.##..##.##
    ##..#####...#
    ..#........#.
    ..#.#.##.#.#.
    ##.#.####.#.#
    ......##.....
    ..#.##..##.#.
    ##.#.####.#.#
    ..###.##.###.
    ###...##...##
    ..#..#..#..#.
    ..#.#....#.#.
    ######..#####
    .....#..#....
    ..#.#.##.#.#.
    ##...####...#
    
    .##.##..#....#..#
    .....####.##.####
    .#...###......###
    .#...............
    .#...############
    #.#......####....
    .#.###..#....#..#
    .#.#.#..#....#..#
    #...#.##......##.
    #.#.#.##.#..#.##.
    ..#...##..##..##.
    
    .##...#.#
    ####...#.
    #..#..#..
    ######.##
    .....#.#.
    ....#..##
    #..######
    .#..##...
    ....##...
    .....###.
    .##...###
    .##.#.###
    .##.#.###
    
    .#.##.######.##
    .#.##.######.##
    #..##.#.##.#.##
    ##..#.######.#.
    .###..#....#..#
    ...#.#.######.#
    ..##.#.####.#.#
    
    .##...##...
    .##.#..#...
    #....#.##..
    .###..#.###
    ....#......
    #.#.#...###
    ..####.#...
    ..####.#...
    #.#.#...###
    ....#......
    .###..#.###
    #....#.##..
    .##.#..#...
    .#....##...
    .##.#..##..
    
    #.#.#..#.#.###..#
    #####..##########
    .#.#.##.#.#.#####
    .#.#.##.#.#.##..#
    ###.#..#.########
    .##..##..##.#....
    ###.####.########
    .######.###..#..#
    ...#.##.#....####
    #...#..#...###..#
    ###......###..##.
    ###.#..#.####....
    ..###..###..##..#
    ####....####..##.
    #.##....##.###..#
    
    .#...#....#...#.#
    #.###......###.##
    ..#.##....##.#..#
    ..#.##....##.#..#
    ...#.##..##.#....
    ####.#....#.#####
    ###.#..##..#.####
    ..##...##...##..#
    ##..########..###
    ##..########..###
    ..##...##...##...
    ###.#..##..#.####
    ####.#....#.#####
    
    ..#.####.##.###
    ###..#.#....#.#
    ###..#.#....#.#
    ..#.####.##.###
    ##....##.##.##.
    #.#.#.##.##.##.
    ##....#.####.#.
    ##......#..#..#
    ##..##.#....#.#
    #..#...######..
    ###.#####..####
    
    #......##.#.#..#.
    #......#..#..##..
    #......#..#.#..#.
    #..##.###...#..#.
    #......#.###.##.#
    ...##...####....#
    .#.##.#.##..#..#.
    ..#..#..#....##..
    ...##....########
    ...##....#.#.##.#
    ###..#####.#.##.#
    
    ..#..####....
    ..####.#.#...
    ...##..#.#.#.
    ..#.#####...#
    ..#..###..#.#
    ....###...#.#
    ....###..##.#
    ..#..###..#.#
    ..#.#####...#
    ...##..#.#.#.
    ..####.#.#...
    ..#..####....
    ..#.#.#.##...
    ###.....###..
    ##.###...#..#
    
    #.....#.#..#..#..
    ...#..#.##...#..#
    .####.#.###..#.##
    .####.#.###..#.##
    ...#..#.##...#..#
    #.....#.#..#..#..
    .##......#.#...#.
    ..#.#.##.....#...
    .#...#.####.#..#.
    .####.#.######.##
    #..#.#...##...#.#
    #..#.#...##...#.#
    .####.#.######.##
    .#...#.####.#..#.
    ..#.#.##.....#...
    .##......#.#...#.
    #.....#.#..##.#..
    
    ..#.#.#
    ..#.#.#
    ....##.
    .##..#.
    #..#.#.
    ....#.#
    ....#..
    .....#.
    ....##.
    
    .........#.
    .#....#....
    ##....##.#.
    #......##.#
    .######...#
    #.......###
    .######..##
    #..##..###.
    #.#..#.#...
    #.#..#.#...
    #..##..###.
    
    ###..#.###.
    ##.##...#..
    .#.#..###..
    .#.###.####
    .#.###.####
    .#.#..###..
    ##.##...#..
    ###..#..##.
    .####.#..#.
    .##...###..
    #...#.#.#.#
    #...#.#.#.#
    .##...###..
    
    .#.#.#.....
    ...###.....
    ....#.#####
    ##..#......
    .###..#####
    ##.....####
    .###.#.####
    .#.#..#....
    .######....
    ....##.####
    ..##.#.....
    #.###.#####
    .##..##....
    .#..##..##.
    #.#...#....
    
    ..#.##.#..#
    #.#....#.##
    #.##..##.#.
    #.##..##.#.
    #.#....#.##
    ..#.##.#..#
    ..#....#...
    ..#######.#
    .#.#..#.#.#
    
    ####..####..#
    ..##..#####.#
    ##..##....##.
    ..##..####..#
    ....#.#..#.#.
    ...#.######.#
    ...#..#..#..#
    
    .###.####.###
    .....####....
    .###..##..###
    ...#......#..
    .####.##.####
    ###..#..#..##
    ....#....#...
    .###..##..###
    #...######...
    #...#.##.#...
    ..##.#..#.##.
    ...#.####.#..
    .##.######.##
    ...#.####.#..
    #....#..#....
    .###.####.###
    #...######...
    
    ###.####.#..#..
    ..##...##.#.#.#
    ##.#..###.##.##
    ..#.##.##.###.#
    ..###..###.##.#
    ......##..##.##
    #####..#.##..#.
    #####...#......
    ###....#.###.#.
    .....#.##.#####
    ##..#.#.##...#.
    ........####.#.
    ........####.#.
    ##..#...##...#.
    .....#.##.#####
    
    ..........####.
    ...##....#....#
    .........##..##
    #......##.####.
    #...#..##..##..
    .#....#...####.
    ........#######
    #.####.###....#
    ##.##.###.####.
    #......#.#....#
    #......#.#.##.#
    
    #######.##....#
    ##.#.##########
    ##..##.#..#..#.
    ###....#.#.##.#
    ######.#..#..#.
    ..###.##.##..##
    ##.##.#..#....#
    ##.#.##........
    #..#..##.#....#
    #.###..#..#..#.
    #.#.#.###.####.
    #.#.#####.####.
    #.###..#..#..#.
    
    ##.###...#.##..#.
    #.#....##.###.#..
    .#.....#.###..#..
    .#.....#.###..#..
    #.#....##.###.##.
    ##.###...#.##..#.
    ..#.###...#..#.##
    #.#.#.##.######..
    #.#.#.##.######..
    ..#.###...#..#.##
    ##.###...#.##..#.
    #.#....##.###.##.
    .#.....#.###..#..
    
    #.#.##..##.#.##..
    ##.#.####.#.##.##
    .####....####.###
    .#.###..###.#..##
    .#.#......#.#..##
    ..#.#.##.#.#.....
    .#...#..#...#.#..
    .#######.####.###
    #..#.#..#.#..####
    .##.##..##.##....
    ..#........#..###
    #..##....##..####
    #.#..#..#..#.#...
    ..##.####.##.....
    #####....#####...
    ##.########.##...
    #.##......##.####
    
    ......###..##
    #####.######.
    .##...##.#.#.
    ########.##..
    ....#..#.....
    .......###.#.
    .##.##.###.#.
    #..####..##.#
    #..####..##.#
    .##.##.###.#.
    .......###.#.
    ....#..#.....
    ########.##..
    .##...##...#.
    #####.######.
    ......###..##
    #########....
    
    ####...####
    .###.#.....
    .###.#.....
    ####...####
    .####.##..#
    .#..#######
    #####...#.#
    #.####.##..
    #.#...#.##.
    #.#####....
    ...###.#.##
    #.#.#.#...#
    ##.#####.##
    #...##.####
    #...#..####
    
    #..#..####..#
    #######..####
    .##..######..
    #...#..##..#.
    ####.##..##.#
    ...###.##.###
    ##..##.##.##.
    .#...##..##..
    #.....####...
    ###...####...
    .....#....#..
    ....########.
    #.#.#..##..#.
    #....#....#..
    #.#..#....#..
    
    .###.####..
    .########..
    .###..###.#
    ##########.
    .###..###..
    .###..###..
    ##########.
    .###..###.#
    .########..
    .###.####..
    #...##...##
    
    #.#.###.#
    #.#.###.#
    ###.#.###
    ...###...
    ..#..##.#
    ..#...#.#
    #.#...#.#
    ..#..##.#
    ...###...
    
    ..##.#...
    ..##.#...
    ...##...#
    ..#..##..
    .#.##.#..
    #...##...
    ##..####.
    #.###.#..
    #.###.#..
    #...####.
    #...##...
    .#.##.#..
    ..#..##..
    ...##...#
    ..##.#...
    
    ###..##...#.#####
    .#.##.#..#.#.....
    #.#####.#.####.##
    .#.#..#.#.###.###
    ##.##.##....#...#
    ##.##.##....#...#
    .#.#..#.#.###.###
    #.#####.#.#######
    .#.##.#..#.#.....
    ###..##...#.#####
    ...#......#.##..#
    ..#.##....#...###
    ......###..#.....
    ..#.##.#.#.....#.
    ..#.##.#.#.....#.
    
    ###.###.#
    ###.#....
    ##.#.###.
    ###.##.##
    ..#..#..#
    ######..#
    ##.###..#
    
    .....#.########
    ..#.###..##.#.#
    ##..#...##..##.
    ##....#.#.#.#..
    #####.####...##
    #...#.#.#.##.##
    #...#.#.#.##.##
    #####.####...##
    ##....#.#.#.#..
    ##..#...##..##.
    ..#.#.#..##.#.#
    .....#.########
    .#....##...####
    ##.###..#..##.#
    ##.###..#..##.#
    
    #########.#..####
    ...##...#..#.#.#.
    ##....##......#..
    .........##..###.
    #..##..###.#.##..
    #..##..#.#.#.##..
    .........##..###.
    ##....##......#..
    ...##...#..#.#.#.
    #########.#..####
    ..####..#.#######
    
    ...####...##.
    .##....##....
    .########.##.
    ##.#..#.#####
    ####..#######
    ####..#.##..#
    ..#.##.#.....
    ##..##..##..#
    #.##..##.#..#
    ##..##..##..#
    #.######.#..#
    .###..###....
    #..#..#..#..#
    ....##....##.
    #.######.#..#
    
    .#.#...
    #......
    .#..#.#
    ..#..#.
    ..###..
    #.#####
    #...###
    #...###
    #.#####
    ..###..
    ..#....
    .#..#.#
    #......
    .#.#...
    #.#..#.
    #.#..#.
    .#.#...
    
    ####..##.....#.
    ....###.###....
    #######.##.#...
    .##..#..###.###
    .##.##..####..#
    .##.#..####.###
    ####.#..##.##..
    .##.####.#.#.#.
    ....#.##.##..##
    ....#.##.##..##
    .##.####.#.#.#.
    ####.#..#####..
    .##.#..####.###
    
    ..####.....
    ##....####.
    ..#..#....#
    #.####.##..
    #.####.##..
    #.####.#.##
    .#....#...#
    #......#.##
    #.####.##..
    ..####..##.
    ..#..#..#.#
    .#.##.#.##.
    .#.##.#.##.
    ..#..#..###
    ..####..##.
    
    #......##..
    .#.##.#..##
    .#....#..##
    .#....#.#..
    ####.###.##
    .######....
    ###..######
    ..####..#..
    ..#..#..#..
    ##....##...
    ##....##...
    ########.##
    ##....##...
    
    ##..###.####.
    ..##..#.#..#.
    #########.#..
    ######.##..#.
    ######.....#.
    ######..#..#.
    ..##......#.#
    ##..####...#.
    ##########.#.
    ##..##.####..
    ..##...###...
    ......##.#.##
    ......###.###
    #######.#####
    ######...#.##
    #.##.###.##..
    ..##..###.#..
    
    #..#.##.###
    .##..##.#.#
    .....#..#.#
    #..##....#.
    ....#####..
    .##.#......
    ....#..#...
    .##.##....#
    #..##.###.#
    .......#.##
    ....#..#.##
    #..##.###.#
    .##.##....#
    "##;
    let lines = read_lines(input);
    println!("{:#?}", lines);

    let mut line_iter = lines.iter();

    let mut patterns: Vec<Grid> = Vec::new();
    loop {
        let mut p1_iter = line_iter.by_ref().take_while(|x| !x.is_empty());
        let pat = get_patterns(&mut p1_iter)?;
        if !pat.rows.is_empty() {
            patterns.push(pat);
        } else {
            break;
        }
    }
    println!("patterns: {:#?}", patterns);

    let axes: Vec<_> = patterns.iter()
            .map(|x| find_mirror_axis(x))
            .collect();
    println!("axes: {:#?}", axes);
    
    let total1: usize = axes.iter().sum();
    println!("Total 1: {}", total1);

    Ok(())
}

fn read_lines(txt: &str) -> Vec<String> {
    txt.trim()
        .lines()
        .map(|x| x.trim())
        // .filter(|x| !x.is_empty())
        .map(|x| x.to_owned())
        .collect()
}

/// Strategy: replace with 0's or 1's and parse as a binary number
/// using big number library
#[derive(Debug)]
struct Grid {
    rows: Vec<UBig>,
    cols: Vec<UBig>,
}

#[derive(Debug)]
struct BadInputError(String);

impl Display for BadInputError {
    fn fmt(&self, f: &mut std::fmt::Formatter<'_>) -> std::fmt::Result {
        write!(f, "BadInput({})", self.0)
    }
}

impl Error for BadInputError {}

fn find_mirror_axis(pat: &Grid) -> usize {
    let row_iter = (1..pat.rows.len())
        .filter(|i| is_mirr_axis(&pat.rows, *i))
        .map(|i| i * 100);

    let col_iter = (1..pat.cols.len())
        .filter(|j| is_mirr_axis(&pat.cols, *j));

    row_iter.chain(col_iter).next().unwrap()
}

fn is_mirr_axis(nums: &Vec<UBig>, n: usize) -> bool {
    let mut j = n - 1;
    let mut k = n;
    loop {
        if j >= nums.len() || k >= nums.len() {
            return true;
        } else if nums[j] != nums[k] {
            return false;
        }
        // because of usize cannot have negatives
        // so decrementing from zero wraps around to usize::MAX
        j = j.wrapping_sub(1);
        k += 1;
    }
}

fn get_patterns<'a, T>(lines: &mut T) -> Result<Grid, Box<dyn Error>>
where
    T: Iterator<Item = &'a String>,
{
    let mut rows: Vec<UBig> = Vec::new();
    // need to do the first line in order to get the number of columns
    let first_line = match lines.next() {
        Some(x) => x,
        None => {
            return Ok(Grid {
                rows,
                cols: Vec::new(),
            })
        }
    };
    let mut col_chars: Vec<String> = iter::repeat_with(String::new)
        .take(first_line.len())
        .collect();

    rows.push(parse_txt(&first_line)?);

    for line in lines {
        rows.push(parse_txt(&line)?);
        for (j, ch) in line.chars().enumerate() {
            col_chars[j].push(ch);
        }
    }
    let cols: Vec<UBig> = col_chars
        .iter()
        .map(|x| parse_txt(x))
        .collect::<Result<_, _>>()?;

    Ok(Grid { rows, cols })
}

fn parse_txt(txt: &str) -> Result<UBig, Box<dyn Error>> {
    let digits: String = txt
        .chars()
        .map(|x| parse_char(x))
        .collect::<Result<_, _>>()?;
    Ok(UBig::from_str_radix(&digits, 2)?)
}

fn parse_char(ch: char) -> Result<char, Box<dyn Error>> {
    if ch == '.' {
        Ok('0')
    } else if ch == '#' {
        Ok('1')
    } else {
        Err(Box::new(BadInputError(format!(
            "expected . or # got: {}",
            ch
        ))))
    }
}
