pub fn run() {
    let input = r##"
    ........#..........................#...............#.....#..................................#..........................#....................
    ..............................................................................#.........................................................#...
    ............#..............................#....................#.........................................#.................................
    ................................#...........................................................................................................
    ....................................................................................................#........................#..............
    ..................#.....#.............................#..............................................................#......................
    .....................................#..............................#......#....................#.......#...................................
    ...................................................................................#................................................#.......
    .......#.....................#..................................#.............................................#.............................
    ..........................................................#............................#....................................................
    #............................................#.....#.......................................................................#................
    ..................................#...........................................#.................................................#.........#.
    ........................#........................................................................#..........................................
    ....#.........#..........................................................................#..........................#.......................
    ..............................#...........#......................#..........................................................................
    ..................#.................#.......................................................................................................
    ...........#................................................................................................................................
    ......................................................#...................#...................#...................................#........#
    ............................#...............#...............................................................................................
    ....#................................................................................................#...............#........#.............
    .....................................#...........#...........#...............#..........#..............................................#....
    ..............#......................................................#......................................#............#..................
    .........#.....................................................................................#............................................
    ........................................................................................................#...................................
    ............................................................................................................................................
    ...#...........................................#..........................#.................................................................
    .................................................................................................#..........................................
    .............................#........................................................#....................#........#...........#...........
    ............#......#.....................#.........#................#.......................................................................
    ......................................................................................................#..................................#..
    ..............................................................#.............................................................................
    .#........................#..............................................................#..................................................
    .........#.........................................................................#...............#...............#...............#........
    ..................................#......................................#..................................................................
    ............................................#............#.......#.............................#............................................
    ............................#.......................#..........................................................#.......#.......#..........#.
    .....#..................................................................................#...................................................
    .................#.....................................................#..............................#.....................................
    .........................................#.....#............#......................................................................#........
    ..........................................................................................................#.................................
    .................................................................#.............#............................................................
    .......................#.....#......................#......................................................................#................
    .#...........#.........................#.....................................................#.........#.........................#..........
    ..................................................................................#..............................#..........................
    .......#...................................................................#................................................................
    ................#..............#......................................................#...........#.....................#.............#.....
    .........................#...................#.............................................................#...............................#
    ............................................................................................................................................
    ........................................#.....................................................................................#.............
    ....................#...............................................#........#........................#.....................................
    ......#....................#................................#...............................#.....................#.........................
    .#..........................................................................................................................................
    ............................................................................................................................................
    ................#.............#...........#..........#............#....................................................#........#.....#.....
    .....................................#...................................................#........#...........#.............................
    ....................#.........................................#............#................................................................
    #.................................................#..................................#.....................................#................
    ............................................#................................................#.....................#........................
    ..................................#.................................................................................................#.......
    .........#...............#..............#........................#............#..............................#..............................
    ..............................#.........................#.......................................#.....#.....................................
    ...............................................#.......................#....................................................................
    .....................#......................................................................................................................
    ...............#...........................................................................................#................................
    ..#...................................#....................................#........................#............#.............#............
    ............................................#............................................#.............................................#....
    ...............................................................#............................................................................
    ........#.......................................................................................#..........................#................
    ..........................#.......#......................#....................#.............................................................
    ....#...........#.....................................................................................................#.....................
    ...................................................................#..............#...................#..........................#..........
    ..............................#..................................................................................#..........................
    .............#......#........................................#.........#..........................#.........................................
    .................................................#...................................#......................#............................#..
    ........#..............................................#....................................................................................
    ......................................#...................................#...................................................#.............
    ............................................................................................................................................
    ........................#.......................................................#.......................#...................................
    ........................................................................................................................#.........#.........
    .......#....................................................................................................................................
    .............................................................#.....#........................#......................#.......................#
    #...........#.........................................................................#.....................................................
    ...................................................#............................................#..........................#.........#......
    ...................#................#....................................................................#.....#............................
    ............................................................................................................................................
    ..........................#............................#.......#.............................#..............................................
    ....#...................................#........#......................#.....#.............................................................
    .....................................................................................................#.................#....................
    ............................................#................................................................#.....................#........
    .........#.......................................................#...................#......................................................
    ............................................................................................................................................
    ................................#........................#.................#................................................................
    ..........................#.........................................#.......................................................#..............#
    .#.................................................#.........#..............................................................................
    ..................#.................#.............................................#.........#...........#............#......................
    .......................................................................................................................................#....
    .........#..................#...............................................................................................................
    ............................................#........................................#.............................................#........
    ........................................................................#...................................................................
    .#.................................................#..............#...........#............................#................................
    ....................#.................#.........................................................#.........................................#.
    .............#.............................................................................#......................#........#................
    ...............................#......................................................................#..........................#..........
    ............................................................................................................................................
    ........................#................................................#..............#...................................................
    ........#.........................#......#.........#.........#..............................................................................
    ..................................................................#................#............................#...........................
    ..............................................................................................#.....#.......................................
    .....#......................................................................#...............................................................
    ...................#.........................#........................................#..............................#..................#...
    .#.........................#.............................#.......................................#................................#.........
    ............................................................................................................................................
    ................................................#........................#...................................................#..............
    ...........#............#.............................................................................#.....................................
    ..................................#................................#...........#....................................#.......................
    #.........................................#....................................................#...............#............................
    .............................#...........................................................................................................#..
    .....#.......#.................................#.......................................#...........................................#........
    ........................................................................................................#...................#...............
    ...................................#.........................#..............................................................................
    .........#...........................................................#.............#..............................#.........................
    ..................#........#.......................#....................................................................#......#........#...
    ........................................................................................#...........#.......................................
    .................................#.......#..................................................................#...............................
    .............#......................................................................................................................#.......
    #.............................................................................#..................#..........................................
    ....................#................#.......................#.............................#............#...................................
    ....................................................................#...........................................#..........#.....#..........
    ...............................#.......................#...............................................................................#....
    ........#.......#...........................................................................................#...............................
    ........................#..................................................................................................................#
    ............................................................................................................................................
    ..............................................................................................#......................................#......
    ..........................................#..............................#...........#............................#.........................
    ............#.............#..................................#..........................................#.................#.................
    ........................................................................................................................................#...
    ...................#.......................................................................#................................................
    #.................................#..................#.......................#..............................................................
    .............................#......................................................................#.....#.....#...................#.......
    ......#........#.................................#............#......#......................................................................
    "##;
    let lines = read_lines(input);
    println!("{:#?}", lines);

    let empties = empty_cols(&lines);
    println!("empties: {:#?}", empties);

    let j_offsets = offset_j(&empties, 1);
    println!("j_offsets: {:#?}", j_offsets);

    let gal_coords = get_galaxy_coords(&lines, &j_offsets, 1);
    println!("gal_coords: {:#?}", gal_coords);

    let lengths = get_path_lengths(&gal_coords);
    // println!("lengths: {:#?}", lengths);

    let total_lengths: usize = lengths.iter().sum();
    println!("total 1: {}", total_lengths);

    let j_offsets2 = offset_j(&empties, 1_000_000 - 1);
    let gal_coords2 = get_galaxy_coords(&lines, &j_offsets2, 1_000_000 - 1);
    let lengths2 = get_path_lengths(&gal_coords2);

    let total_lengths2: usize = lengths2.iter().sum();
    println!("total 2: {}", total_lengths2);
}

fn read_lines(txt: &str) -> Vec<String> {
    txt.lines()
        .map(|x| x.trim())
        .filter(|x| !x.is_empty())
        .map(|x| x.to_owned())
        .collect()
}

#[derive(Debug, Clone, Copy)]
struct Point {
    i: usize,
    j: usize,
}

impl Point {
    fn len_between(&self, other: Self) -> usize {
        self.i.abs_diff(other.i) + self.j.abs_diff(other.j)
    }
}

/// Empty columns marked with 1
fn empty_cols(lines: &Vec<String>) -> Vec<i32> {
    let n_cols = lines[0].len();
    // start with all ones and then zero
    // any columns that contain a #
    let mut empties = vec![1; n_cols];
    for row in lines {
        for (j, ch) in row.chars().enumerate() {
            if ch == '#' {
                empties[j] = 0;
            }
        }
    }
    empties
}

/// compute offset of j coordinate
fn offset_j(empty_cols: &Vec<i32>, offset_val: usize) -> Vec<usize> {
    let mut cur_offset: usize = 0;
    let mut offsets = Vec::new();
    for empty_label in empty_cols {
        // 1 means an empty column
        if *empty_label == 1 {
            cur_offset += offset_val;
        }
        offsets.push(cur_offset);
    }
    offsets
}

/// coordinates of the galaxies including offsets due to expansion
fn get_galaxy_coords(lines: &Vec<String>, j_offsets: &Vec<usize>, offset_val: usize) -> Vec<Point> {
    let mut i_offset: usize = 0;
    let mut coords = Vec::new();
    for (i, row) in lines.iter().enumerate() {
        let mut empty_row = true;
        for (j, ch) in row.chars().enumerate() {
            if ch == '#' {
                empty_row = false;
                coords.push(Point {
                    i: i + i_offset,
                    j: j + j_offsets[j],
                });
            }
        }
        if empty_row {
            i_offset += offset_val;
        }
    }
    coords
}

fn get_path_lengths(gals: &Vec<Point>) -> Vec<usize> {
    let mut p_lengths = Vec::new();
    for i in 0..gals.len() - 1 {
        for j in i + 1..gals.len() {
            p_lengths.push(gals[i].len_between(gals[j]));
        }
    }
    p_lengths
}
